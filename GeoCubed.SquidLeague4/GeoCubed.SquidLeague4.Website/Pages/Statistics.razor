@page "/statistics"

@using GeoCubed.SquidLeague4.Website.Models.Enums
@using GeoCubed.SquidLeague4.Website.Common.Helpers

<div class="text-center">
    <h1 class="mb-3 mt-1">Statistics</h1>

    <select class="form-control mb-3" @onchange="OnStatsSelectAsync">
        <option value="-1">Select Statistic:</option>
        @foreach (var statsOpt in this.StatsOptions)
        {
            <option value="@statsOpt.Id">@statsOpt.Alias</option>
        }
    </select>

    <div>
        @if (this.SelectedStats == null)
        {
            <h2>Please select a statistic to view</h2>
        }
        else 
        {
            if (this.SelectedStats.Modifier == StatsModifiers.Mode.GetDescription())
            {
                <h2>Game Modes</h2>
                <select class="form-control mb-3" @ref="this.selectModeModifier" @onchange="OnModifierSelectAsync">
                    <option value="-1">All Modes</option>
                    @foreach (var mode in this.statsModifiersVm.Modes)
                    {
                        <option value="@mode.Key">@mode.Value</option>
                    }
                </select>
            }
            else if (this.SelectedStats.Modifier == StatsModifiers.Weapon.GetDescription())
            {
                <h2>Weapons</h2>
                <select class="form-control mb-3" @ref="this.selectWeaponModifier" @onchange="OnModifierSelectAsync">
                    <option value="-1">All Weapons</option>
                    @foreach (var weapon in this.statsModifiersVm.Weapons)
                    {
                        <option value="@weapon.Key">@weapon.Value</option>
                    }
                </select>
            }

            @if (string.IsNullOrEmpty(this.dataLabelsTruncated) || string.IsNullOrEmpty(this.dataValues))
            {
                <h2>This has no data</h2>
            }
            else
            {
                <h2>@this.tableTitle</h2>
                <div style="margin:auto;max-width:700px;">
                    @if (this.StrongDataType == "double")
                    {
                        <p>@this.dataValues</p>
                        <p>@this.dataLabelsTruncated</p>
                        <Chart @ref="this.DoubleChart" Type="ChartType.Bar" TItem="double"/>
                    }
                    else if (this.StrongDataType == "int")
                    {
                        <DonutChart InputData="@this.dataValues" InputLabels="@this.dataLabelsTruncated">
                        </DonutChart>    
                    }
                    else
                    {
                        <h3>Idk what chart to use here</h3>
                    }
                </div>
                <div style="margin:auto;max-width:400px">
                    <h3>Full Data</h3>
                    <ul class="list-group">
                        @for (int i = 0; i < this.fullData.Count; ++i)
                        {
                            <li class="list-group-item">@string.Format("{0}. {1} - {2}", i + 1, this.fullData[i].Key, this.fullData[i].Value)</li>
                        }
                    </ul>
                </div>
            }
        }
    </div>
</div>